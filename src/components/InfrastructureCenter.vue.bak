<template>
  <div
    class="w-full bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-4 sm:p-5 lg:p-6 shadow-2xl text-center"
    ref="container"
  >
    <h1
      class="text-2xl sm:text-3xl font-extrabold text-red-400 mb-6 tracking-wide drop-shadow-lg"
    >
      Infrastructure Layer
    </h1>

    <!-- Cards Row -->
    <div class="flex flex-col sm:flex-row gap-6 items-stretch">
      <!-- OpenStack Card -->
      <div
        class="flex-1 bg-white/5 backdrop-blur-xl border border-white/30 rounded-2xl p-4 sm:p-6 shadow-lg flex flex-col hover:shadow-[0_0_25px_rgba(248,113,113,0.35)] transition-shadow duration-300"
        ref="openstackCol"
      >
        <h3
          class="text-xl sm:text-2xl text-red-400 mb-4 text-center font-semibold tracking-tight"
        >
          OpenStack
        </h3>
        <div class="flex flex-wrap justify-center gap-3">
          <div
            v-for="s in infra.openstack"
            :key="s.name"
            class="bg-white/5 backdrop-blur-xl border border-white/20 rounded-lg px-3 py-2 cursor-pointer text-xs sm:text-sm font-medium text-slate-100 hover:bg-red-500/20 hover:border-red-400 hover:text-white transition-all duration-200 transform hover:scale-105 shadow-inner flex items-center gap-3"
            @mouseenter="hoverIn($event)"
            @mouseleave="hoverOut($event)"
            @click="go(s.url)"
          >
            <!-- Logo (SimpleIcons) -->
            <img
              v-if="s.logo"
              :src="`https://cdn.simpleicons.org/${s.logo}/d1d5db`"
              alt="logo"
              class="w-6 h-6 sm:w-8 sm:h-8 object-contain"
              @error="$event.target.style.display = 'none'"
            />
            <!-- Service Name -->
            <span>{{ s.name }}</span>
          </div>
        </div>
      </div>

      <!-- Ceph Card -->
      <div
        class="flex-1 bg-white/5 backdrop-blur-xl border border-white/30 rounded-2xl p-4 sm:p-6 shadow-lg flex flex-col hover:shadow-[0_0_25px_rgba(251,146,60,0.35)] transition-shadow duration-300"
        ref="cephCol"
      >
        <h3
          class="text-xl sm:text-2xl text-orange-400 mb-4 text-center font-semibold tracking-tight"
        >
          Ceph
        </h3>
        <div class="flex flex-wrap justify-center gap-3">
          <div
            v-for="s in infra.ceph"
            :key="s.name"
            class="bg-white/5 backdrop-blur-xl border border-white/20 rounded-lg px-3 py-2 cursor-pointer text-xs sm:text-sm font-medium text-slate-100 hover:bg-orange-500/20 hover:border-orange-400 hover:text-white transition-all duration-200 transform hover:scale-105 shadow-inner flex items-center gap-3"
            @mouseenter="hoverIn($event)"
            @mouseleave="hoverOut($event)"
            @click="go(s.url)"
          >
            <!-- Logo (SimpleIcons) -->
            <img
              v-if="s.logo"
              :src="`https://cdn.simpleicons.org/${s.logo}/d1d5db`"
              alt="logo"
              class="w-6 h-6 sm:w-8 sm:h-8 object-contain"
              @error="$event.target.style.display = 'none'"
            />
            <!-- Service Name -->
            <span>{{ s.name }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<script setup>
import { onMounted, ref, nextTick } from "vue";
import gsap from "gsap";
import infra from "../data/infrastructure.json";

const container = ref(null);
const openstackCol = ref(null);
const cephCol = ref(null);

onMounted(() => {
  nextTick(() => {
    gsap.from(container.value, {
      opacity: 0,
      y: 20,
      duration: 0.6,
      ease: "power3.out",
    });

    gsap.from([openstackCol.value, cephCol.value], {
      opacity: 0,
      y: 15,
      stagger: 0.2,
      duration: 0.5,
      ease: "power3.out",
    });

    gsap.from(openstackCol.value.children[1].children, {
      opacity: 0,
      y: 8,
      stagger: 0.1,
      duration: 0.35,
    });

    gsap.from(cephCol.value.children[1].children, {
      opacity: 0,
      y: 8,
      stagger: 0.1,
      duration: 0.35,
    });
  });
});

// Hover animation
const hoverIn = (el) => {
  gsap.to(el.currentTarget ?? el, {
    scale: 1.05,
    duration: 0.2,
  });
};

const hoverOut = (el) => {
  gsap.to(el.currentTarget ?? el, {
    scale: 1,
    duration: 0.2,
  });
};

// Navigation
const go = (url) => url && window.open(url, "_blank");
</script>
